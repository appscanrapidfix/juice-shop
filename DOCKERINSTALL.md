# Docker Installation Jucie Shop

This hosting guide shows you how to self-host a juice shop instance on a cloud server (e.g. Hetzner) or on your local machine.

Components in use:

- Caddy Reverse Proxy + https certs will be autogenerated
- Juice Shop Backend
- Docker Compose to set up components and manage how they work togehter

## Preparation

Install Docker on the machine

```
apt update && apt -y upgrade
apt install docker-compose-plugin
```

## Clone configuration repository

```
(sudo) docker volume create caddy_data
(sudo) docker volume create js_data
```

## Set up DNS

Usually a subdomain or domain would be a good starting point. Create a DNS Entry for a subdomain with A and AAAA Record pointing to your server.

## Open Ports

```
(sudo) ufw allow 80
(sudo) ufw allow 443
```

## The Docker Compose file

- The Caddy service definition defines the ports it uses and the local volumes to copy to the containers.
- The juice-shop service definition defines the ports it uses and the volumes it needs to copy to the containers.

The variables are definded in the **.env** file.

## Caddy Configuration

Edit the Caddyfile in caddy_config folder to suit your needs.

```
vi caddy_config/Caddyfile
```

We use the network name juice-shop from docker-compose.yml to connect to the backend.

```
js.<domain>.<suffix> {
    reverse_proxy juice-shop:3000 {
      flush_interval -1
    }
}
```

In .env File you have to setup a Domain and an email address for autoenrollment of Certs

_DATA_FOLDER_ -

_DATA_FOLDER_ -

_SSL_EMAIL_ -

## Start Docker Compose

With the following command we can start up our reverse proxy and backend.

```
docker compose --env-file .env up -d
```

## Stop your Juice Shop instance

With this command we can stop the stack

```
(sudo) docker compose stop
```

Happy Hacking!
